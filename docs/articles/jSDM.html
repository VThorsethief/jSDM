<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started with jSDM • jSDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started with jSDM">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://twitter.com/ghislainv">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ghislainv/jSDM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Get started with jSDM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ghislainv/jSDM/blob/master/vignettes/jSDM.Rmd"><code>vignettes/jSDM.Rmd</code></a></small>
      <div class="hidden name"><code>jSDM.Rmd</code></div>

    </div>

    
    
<p>Joint Species distribution models (jSDM) are useful tools to explain or predict species range and abundance from various environmental factors and species correlations <span class="citation">(Warton <em>et al.</em> <a href="#ref-Warton2015">2015</a>)</span>. jSDM is becoming an increasingly popular statistical method in conservation biology. In this vignette, we illustrate the use of the <code>jSDM</code> R package wich aims at providing user-friendly statistical functions using field observations (occurence or abundance data) to fit jSDMs models. Package’s functions are developped in a hierarchical Bayesian framework and use conjugate priors to estimate model’s parameters. Using compiled C code for the Gibbs sampler reduce drastically the computation time. By making these new statistical tools available to the scientific community, we hope to democratize the use of more complex, but more realistic, statistical models for increasing knowledge in ecology and conserving biodiversity.</p>
<p>Below, we show an example of the use of <code>jSDM</code> for fitting species distribution model to abundance data for 9 frog’s species. Model types available in <code>jSDM</code> are not limited to those described in this example. <code>jSDM</code> includes various model types for occurrence data:</p>
<div id="definition-of-the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#definition-of-the-model" class="anchor"></a><span class="header-section-number">1</span> Definition of the model</h1>
<p>Referring to the models used in the articles <span class="citation">(Warton <em>et al.</em> <a href="#ref-Warton2015">2015</a>)</span> and <span class="citation">(Albert &amp; Siddhartha <a href="#ref-Albert1993">1993</a>)</span>, we define the following model :</p>
<p><span class="math display">\[ \mathrm{probit}(\theta_{i,j}) =\alpha_i + \beta_{0j}+X_i'\beta_j+ W_i'\lambda_j \]</span></p>
<ul>
<li><p>Link function probit: <span class="math inline">\(\mathrm{probit} : q \rightarrow \Phi^{-1}(q)\)</span> where <span class="math inline">\(\Phi\)</span> correspond to the repartition function of the reduced centred normal distribution.</p></li>
<li><p>Response variable: <span class="math inline">\(Y=(y_{i,j})^{i=1,\ldots,nsite}_{j=1,\ldots,nsp}\)</span> with:</p></li>
</ul>
<p><span class="math display">\[y_{i,j}=\begin{cases}
    0 &amp; \text{ if species $j$ is absent on the site $i$}\\
    1 &amp;  \text{ if species  $j$ is present on the site $i$}
    \end{cases}.\]</span></p>
<ul>
<li>Latent variable <span class="math inline">\(Z_{i,j} = \alpha_i + \beta_{0j}+X_i'\beta_j+ W_i'\lambda_j + \epsilon_{i,j}\)</span>, with <span class="math inline">\(\forall i,j \ \epsilon_{i,j} \sim \mathcal{N}(0,1)\)</span> and such as:</li>
</ul>
<p><span class="math display">\[y_{i,j}=\begin{cases}
    1 &amp; \text{ if } Z_{i,j} &gt; 0 \\
    0 &amp;  \text{ otherwise.}
    \end{cases}\]</span></p>
<p>It can be easily shown that: <span class="math inline">\(y_{i,j}| Z_i \sim \mathcal{B}ernouilli(\theta_{i,j})\)</span>.</p>
<ul>
<li><p>Latent variables: <span class="math inline">\(W_i=(W_i^1,\ldots,W_i^q)\)</span> where <span class="math inline">\(q\)</span> is the number of latent variables considered, which has to be fixed by the user (by default q=2).
We assume that <span class="math inline">\(W_i \sim \mathcal{N}(0,I_q)\)</span> and we define the associated coefficients: <span class="math inline">\(\lambda_j=(\lambda_j^1,\ldots, \lambda_j^q)'\)</span>.</p></li>
<li><p>Explanatory variables: bioclimatic data about each site. <span class="math inline">\(X=(X_i)_{i=1,\ldots,nsite}\)</span> avec <span class="math inline">\(X_i=(x_i^1,\ldots,x_i^p)'\in \mathbb{R}^p\)</span> where <span class="math inline">\(p\)</span> is the number of bioclimatic variables considered.
The corresponding regression coefficients for each species $ j $ are noted : <span class="math inline">\(\beta_j=(\beta_j^1,\ldots,\beta_j^p)'\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_{0j}\)</span> correspond to the intercept for species <span class="math inline">\(j\)</span> which is assume to be a fixed effect.</p></li>
<li><p><span class="math inline">\(\alpha_i\)</span> represents the random effect of site <span class="math inline">\(i\)</span>.</p></li>
</ul>
</div>
<div id="data-set" class="section level1">
<h1 class="hasAnchor">
<a href="#data-set" class="anchor"></a><span class="header-section-number">2</span> Data-set</h1>

<div class="figure" style="text-align: center">
<span id="fig:frog-picture"></span>
<img src="figures/frog.jpg" alt="Frog. Wilkinson et al. (2019)." width="\textwidth"><p class="caption">
Figure 2.1: <strong>Frog</strong>. <span class="citation">Wilkinson <em>et al.</em> (<a href="#ref-Wilkinson2019">2019</a>)</span>.
</p>
</div>
<p>We first load the <code>jSDM</code> library.</p>
<pre class="sourceCode r" id="cb1"><code class="sourceCode r"><div class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load libraries</span></div>
<div class="sourceLine" id="cb1-2" data-line-number="2">
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(jSDM)</div>
<div class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; ##</span></div>
<div class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; ## jSDM R package </span></div>
<div class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; ## For joint species distribution models </span></div>
<div class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; ##</span></div></code></pre>
<p>This data-set is available in the <code>jSDM</code> R package. It can be loaded with the <code>data</code> command. The data is in “wide” format: each line is a site and the occurrence data (from Species_1 to Species_9) are in columns. A site is characterized by its x-y geographical coordinates, one discrete covariates and two other continuous.</p>
<pre class="sourceCode r" id="cb2"><code class="sourceCode r"><div class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># frogs data</span></div>
<div class="sourceLine" id="cb2-2" data-line-number="2">
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(frogs, <span class="dt">package=</span><span class="st">"jSDM"</span>)</div>
<div class="sourceLine" id="cb2-3" data-line-number="3">
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(frogs)</div>
<div class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;   Covariate_1 Covariate_2 Covariate_3 Species_1 Species_2 Species_3</span></div>
<div class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 1    3.870111           0    0.045334         1         0         0</span></div>
<div class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 2    3.326950           1    0.115903         0         0         0</span></div>
<div class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; 3    2.856729           1    0.147034         0         0         0</span></div>
<div class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 4    1.623249           1    0.124283         0         0         0</span></div>
<div class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; 5    4.629685           1    0.081655         0         0         0</span></div>
<div class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 6    0.698970           1    0.107048         0         0         0</span></div>
<div class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;   Species_4 Species_5 Species_6 Species_7 Species_8 Species_9        y</span></div>
<div class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 1         0         0         0         0         0         0 66.41479</span></div>
<div class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; 2         0         0         1         0         0         0 67.03841</span></div>
<div class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; 3         0         0         1         0         0         0 67.03855</span></div>
<div class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; 4         0         0         1         0         0         0 67.04200</span></div>
<div class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; 5         0         0         1         0         0         0 67.04439</span></div>
<div class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; 6         0         0         0         0         0         0 67.03894</span></div>
<div class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;          x</span></div>
<div class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; 1 9.256424</span></div>
<div class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; 2 9.025588</span></div>
<div class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; 3 9.029416</span></div>
<div class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; 4 9.029745</span></div>
<div class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; 5 9.026514</span></div>
<div class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; 6 9.023580</span></div></code></pre>
<p>We rearrange the data in two data-sets, one for the observation (or detection) process and one for the suitability (or ecological) process.</p>
<p>We normalize the continuous data to facilitate MCMC convergence.</p>
<pre class="sourceCode r" id="cb3"><code class="sourceCode r"><div class="sourceLine" id="cb3-1" data-line-number="1"></div>
<div class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># data.suit</span></div>
<div class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># Normalized continuous variables</span></div>
<div class="sourceLine" id="cb3-4" data-line-number="4">Env_frogs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/scale">scale</a></span>(frogs[,<span class="dv">1</span>]),frogs[,<span class="dv">2</span>],<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/scale">scale</a></span>(frogs[,<span class="dv">3</span>]))</div>
<div class="sourceLine" id="cb3-5" data-line-number="5">
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(Env_frogs) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span> (frogs[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</div>
<div class="sourceLine" id="cb3-6" data-line-number="6"></div>
<div class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># data.obs</span></div>
<div class="sourceLine" id="cb3-8" data-line-number="8">PA_frogs &lt;-<span class="st"> </span>frogs[,<span class="dv">4</span><span class="op">:</span><span class="dv">12</span>]</div></code></pre>
</div>
<div id="parameter-inference" class="section level1">
<h1 class="hasAnchor">
<a href="#parameter-inference" class="anchor"></a><span class="header-section-number">3</span> Parameter inference</h1>
<p>We use the <code><a href="../reference/jSDM_probit_block.html">jSDM_probit_block()</a></code> function.</p>
<pre class="sourceCode r" id="cb4"><code class="sourceCode r"><div class="sourceLine" id="cb4-1" data-line-number="1">mod_jSDM_block_frogs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/jSDM_probit_block.html">jSDM_probit_block</a></span> (</div>
<div class="sourceLine" id="cb4-2" data-line-number="2">  <span class="co"># Response variable </span>
</div>
<div class="sourceLine" id="cb4-3" data-line-number="3">  <span class="dt">presence_site_sp =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">as.matrix</a></span>(PA_frogs), </div>
<div class="sourceLine" id="cb4-4" data-line-number="4">  <span class="co"># Explanatory variables </span>
</div>
<div class="sourceLine" id="cb4-5" data-line-number="5">  <span class="dt">site_suitability =</span> <span class="op">~</span>.,   </div>
<div class="sourceLine" id="cb4-6" data-line-number="6">  <span class="dt">site_data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(Env_frogs), <span class="dt">n_latent=</span><span class="dv">2</span>,</div>
<div class="sourceLine" id="cb4-7" data-line-number="7">  <span class="co"># Chains</span>
</div>
<div class="sourceLine" id="cb4-8" data-line-number="8">  <span class="dt">burnin=</span><span class="dv">10000</span>, <span class="dt">mcmc=</span><span class="dv">5000</span>, <span class="dt">thin=</span><span class="dv">5</span>,</div>
<div class="sourceLine" id="cb4-9" data-line-number="9">  <span class="co"># Starting values</span>
</div>
<div class="sourceLine" id="cb4-10" data-line-number="10">  <span class="dt">alpha_start=</span><span class="dv">0</span>, <span class="dt">beta_start=</span><span class="dv">0</span>,</div>
<div class="sourceLine" id="cb4-11" data-line-number="11">  <span class="dt">lambda_start=</span><span class="dv">0</span>, <span class="dt">W_start=</span><span class="dv">0</span>,</div>
<div class="sourceLine" id="cb4-12" data-line-number="12">  <span class="dt">V_alpha_start=</span><span class="dv">1</span>, </div>
<div class="sourceLine" id="cb4-13" data-line-number="13">  <span class="co"># Priors</span>
</div>
<div class="sourceLine" id="cb4-14" data-line-number="14">  <span class="dt">shape=</span><span class="fl">0.5</span>, <span class="dt">rate=</span><span class="fl">0.0005</span>,</div>
<div class="sourceLine" id="cb4-15" data-line-number="15">  <span class="dt">mu_beta=</span><span class="dv">0</span>, <span class="dt">V_beta=</span><span class="fl">1.0E6</span>,</div>
<div class="sourceLine" id="cb4-16" data-line-number="16">  <span class="dt">mu_lambda=</span><span class="dv">0</span>, <span class="dt">V_lambda=</span><span class="dv">10</span>,</div>
<div class="sourceLine" id="cb4-17" data-line-number="17">  <span class="co"># Various </span>
</div>
<div class="sourceLine" id="cb4-18" data-line-number="18">  <span class="dt">seed=</span><span class="dv">1234</span>, <span class="dt">verbose=</span><span class="dv">1</span>)</div>
<div class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; Running the Gibbs sampler. It may be long, please keep cool :)</span></div>
<div class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; </span></div>
<div class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; **********:10.0% </span></div>
<div class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; **********:20.0% </span></div>
<div class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; **********:30.0% </span></div>
<div class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt; **********:40.0% </span></div>
<div class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; **********:50.0% </span></div>
<div class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; **********:60.0% </span></div>
<div class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; **********:70.0% </span></div>
<div class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; **********:80.0% </span></div>
<div class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; **********:90.0% </span></div>
<div class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; **********:100.0%</span></div></code></pre>
</div>
<div id="analysis-of-the-results" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-the-results" class="anchor"></a><span class="header-section-number">4</span> Analysis of the results</h1>
<pre class="sourceCode r" id="cb5"><code class="sourceCode r"><div class="sourceLine" id="cb5-1" data-line-number="1">## alpha_i of 3 first sites</div>
<div class="sourceLine" id="cb5-2" data-line-number="2">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/mcmc">mcmc</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.alpha[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]))</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-1.png" width="576" style="display: block; margin: auto;"></p>
<pre class="sourceCode r" id="cb6"><code class="sourceCode r"><div class="sourceLine" id="cb6-1" data-line-number="1"></div>
<div class="sourceLine" id="cb6-2" data-line-number="2">## Valpha</div>
<div class="sourceLine" id="cb6-3" data-line-number="3">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</div>
<div class="sourceLine" id="cb6-4" data-line-number="4">coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/traceplot">traceplot</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.Valpha, <span class="dt">main =</span> <span class="st">"V_alpha"</span>)</div>
<div class="sourceLine" id="cb6-5" data-line-number="5">coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/densplot">densplot</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.Valpha, <span class="dt">main =</span> <span class="st">"V_alpha"</span>)</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-2.png" width="576" style="display: block; margin: auto;"></p>
<pre class="sourceCode r" id="cb7"><code class="sourceCode r"><div class="sourceLine" id="cb7-1" data-line-number="1"></div>
<div class="sourceLine" id="cb7-2" data-line-number="2">np &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(mod_jSDM_block_frogs<span class="op">$</span>model_spec<span class="op">$</span>beta_start)</div>
<div class="sourceLine" id="cb7-3" data-line-number="3">## beta_j of two first species</div>
<div class="sourceLine" id="cb7-4" data-line-number="4">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(np,<span class="dv">2</span>))</div>
<div class="sourceLine" id="cb7-5" data-line-number="5">
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</div>
<div class="sourceLine" id="cb7-6" data-line-number="6">  <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>np) {</div>
<div class="sourceLine" id="cb7-7" data-line-number="7">      coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/traceplot">traceplot</a></span>(coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/mcmc">as.mcmc</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.sp[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"sp_"</span>,j)]][,p]))</div>
<div class="sourceLine" id="cb7-8" data-line-number="8">      coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/densplot">densplot</a></span>(coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/mcmc">as.mcmc</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.sp[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"sp_"</span>,j)]][,p]), </div>
<div class="sourceLine" id="cb7-9" data-line-number="9">
<span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.sp[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"sp_"</span>,j)]])[p],</div>
<div class="sourceLine" id="cb7-10" data-line-number="10">
<span class="st">", species : "</span>,j))</div>
<div class="sourceLine" id="cb7-11" data-line-number="11">  }</div>
<div class="sourceLine" id="cb7-12" data-line-number="12">}</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-3.png" width="576" style="display: block; margin: auto;"><img src="jSDM_files/figure-html/plot-results-4.png" width="576" style="display: block; margin: auto;"><img src="jSDM_files/figure-html/plot-results-5.png" width="576" style="display: block; margin: auto;"></p>
<pre class="sourceCode r" id="cb8"><code class="sourceCode r"><div class="sourceLine" id="cb8-1" data-line-number="1"></div>
<div class="sourceLine" id="cb8-2" data-line-number="2">n_latent &lt;-<span class="st"> </span>mod_jSDM_block_frogs<span class="op">$</span>model_spec<span class="op">$</span>n_latent</div>
<div class="sourceLine" id="cb8-3" data-line-number="3">## lambda_j of 2 first species</div>
<div class="sourceLine" id="cb8-4" data-line-number="4">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(n_latent<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>))</div>
<div class="sourceLine" id="cb8-5" data-line-number="5">
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</div>
<div class="sourceLine" id="cb8-6" data-line-number="6">  <span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_latent) {</div>
<div class="sourceLine" id="cb8-7" data-line-number="7">      coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/traceplot">traceplot</a></span>(coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/mcmc">as.mcmc</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.sp[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"sp_"</span>,j)]][,np<span class="op">+</span>l]))</div>
<div class="sourceLine" id="cb8-8" data-line-number="8">      coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/densplot">densplot</a></span>(coda<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/coda/topics/mcmc">as.mcmc</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.sp[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"sp_"</span>,j)]][,np<span class="op">+</span>l]), </div>
<div class="sourceLine" id="cb8-9" data-line-number="9">      <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.sp[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"sp_"</span>,j)]])[np<span class="op">+</span>l],</div>
<div class="sourceLine" id="cb8-10" data-line-number="10">      <span class="st">", species : "</span>,j))</div>
<div class="sourceLine" id="cb8-11" data-line-number="11">    }</div>
<div class="sourceLine" id="cb8-12" data-line-number="12">  }</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-6.png" width="576" style="display: block; margin: auto;"></p>
<pre class="sourceCode r" id="cb9"><code class="sourceCode r"><div class="sourceLine" id="cb9-1" data-line-number="1"></div>
<div class="sourceLine" id="cb9-2" data-line-number="2">## Latent variables W_i of 2 first sites</div>
<div class="sourceLine" id="cb9-3" data-line-number="3">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</div>
<div class="sourceLine" id="cb9-4" data-line-number="4">
<span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_latent) {</div>
<div class="sourceLine" id="cb9-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.latent[[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"lv_"</span>,l)]][,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">main =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"Latent variable W_"</span>, l))</div>
<div class="sourceLine" id="cb9-6" data-line-number="6">}</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-7.png" width="576" style="display: block; margin: auto;"><img src="jSDM_files/figure-html/plot-results-8.png" width="576" style="display: block; margin: auto;"></p>
<pre class="sourceCode r" id="cb10"><code class="sourceCode r"><div class="sourceLine" id="cb10-1" data-line-number="1"></div>
<div class="sourceLine" id="cb10-2" data-line-number="2">## probit_theta</div>
<div class="sourceLine" id="cb10-3" data-line-number="3">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mod_jSDM_block_frogs<span class="op">$</span>mcmc.Deviance,<span class="dt">main =</span> <span class="st">"Deviance"</span>)</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-9.png" width="576" style="display: block; margin: auto;"></p>
<pre class="sourceCode r" id="cb11"><code class="sourceCode r"><div class="sourceLine" id="cb11-1" data-line-number="1">## Deviance</div>
<div class="sourceLine" id="cb11-2" data-line-number="2">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span> (<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>))</div>
<div class="sourceLine" id="cb11-3" data-line-number="3">
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/hist">hist</a></span>(mod_jSDM_block_frogs<span class="op">$</span>probit_theta_pred, <span class="dt">main =</span> <span class="st">"Predicted probit theta"</span>)</div></code></pre>
<p><img src="jSDM_files/figure-html/plot-results-10.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="matrice-of-correlations" class="section level1">
<h1 class="hasAnchor">
<a href="#matrice-of-correlations" class="anchor"></a><span class="header-section-number">5</span> Matrice of correlations</h1>
<pre class="sourceCode r" id="cb12"><code class="sourceCode r"><div class="sourceLine" id="cb12-1" data-line-number="1">
<span class="kw"><a href="../reference/plot_residual_cor.html">plot_residual_cor</a></span>(mod_jSDM_block_frogs)</div></code></pre>
<p><img src="jSDM_files/figure-html/correlation-matrix-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Albert1993">
<p>Albert, J.H. &amp; Siddhartha, C. (1993) Bayesian analysis of binary and polychotomous response data. <em>Journal of the American Statistical Association</em>, <strong>88</strong>, 669–679.</p>
</div>
<div id="ref-Warton2015">
<p>Warton, D.I., Blanchet, F.G., O’Hara, R.B., Ovaskainen, O., Taskinen, S., Walker, S.C. &amp; Hui, F.K. (2015) So many variables: Joint modeling in community ecology. <em>Trends in Ecology &amp; Evolution</em>, <strong>30</strong>, 766–779.</p>
</div>
<div id="ref-Wilkinson2019">
<p>Wilkinson, D.P., Golding, N., Guillera-Arroita, G., Tingley, R. &amp; McCarthy, M.A. (2019) A comparison of joint species distribution models for presence–absence data. <em>Methods in Ecology and Evolution</em>, <strong>10</strong>, 198–211.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#definition-of-the-model"><span class="toc-section-number">1</span> Definition of the model</a></li>
      <li><a href="#data-set"><span class="toc-section-number">2</span> Data-set</a></li>
      <li><a href="#parameter-inference"><span class="toc-section-number">3</span> Parameter inference</a></li>
      <li><a href="#analysis-of-the-results"><span class="toc-section-number">4</span> Analysis of the results</a></li>
      <li><a href="#matrice-of-correlations"><span class="toc-section-number">5</span> Matrice of correlations</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://ecology.ghislainv.fr">Ghislain Vieilledent</a>, Jeanne Clément, <a href="https://www.cirad.fr"><img src="https://ecology.ghislainv.fr/images/logos/logo-cirad.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
