<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Binomial probit regression model — jSDM_probit_block • jSDM</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Binomial probit regression model — jSDM_probit_block" />

<meta property="og:description" content="The jSDM_probit_block function performs a Binomial probit regression in a Bayesian framework. The function calls a Gibbs sampler written in C++ code which uses conjugate priors
to estimate the conditional posterior distribution of
model's parameters." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/jSDM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jSDM_boral.html">Comparison jSDM-boral</a>
    </li>
    <li>
      <a href="../articles/proof.html">Mathematical proof</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://twitter.com/ghislainv">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ghislainv/jSDM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Binomial probit regression model</h1>
    
    <div class="hidden name"><code>jSDM_probit_block.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The <code>jSDM_probit_block</code> function performs a Binomial probit regression in a Bayesian framework. The function calls a Gibbs sampler written in C++ code which uses conjugate priors
to estimate the conditional posterior distribution of
model's parameters.</p>
    
    </div>

    <pre class="usage"><span class='fu'>jSDM_probit_block</span>(<span class='no'>presence_site_sp</span>, <span class='no'>site_suitability</span>,
<span class='no'>site_data</span>, <span class='kw'>n_latent</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>5000</span>, <span class='kw'>mcmc</span><span class='kw'>=</span><span class='fl'>15000</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>10</span>,
<span class='kw'>alpha_start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>beta_start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>lambda_start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>W_start</span><span class='kw'>=</span><span class='fl'>0</span>,
<span class='kw'>V_alpha_start</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>0.5</span>, <span class='kw'>rate</span><span class='kw'>=</span><span class='fl'>0.0005</span>,
<span class='kw'>mu_beta</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>V_beta</span><span class='kw'>=</span><span class='fl'>1.0E6</span>, <span class='kw'>mu_lambda</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>V_lambda</span><span class='kw'>=</span><span class='fl'>10</span>,
<span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>1234</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>1</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>presence_site_sp</th>
      <td><p>A matrix \(n_{site} \times n_{species}\) indicating the presence by a 1 (or the absence by a 0) of each species on each site.</p></td>
    </tr>
    <tr>
      <th>n_latent</th>
      <td><p>An integer indicating the number of latent variables.</p></td>
    </tr>
    <tr>
      <th>site_suitability</th>
      <td><p>A one-sided formula of the form '~x1+...+xp' with p terms specifying the explicative variables for the suitability process of the model.</p></td>
    </tr>
    <tr>
      <th>site_data</th>
      <td><p>A data frame containing the model's explicative
    variables by site.</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>The number of burnin iterations for the sampler.</p></td>
    </tr>
    <tr>
      <th>mcmc</th>
      <td><p>The number of Gibbs iterations for the sampler. Total
    number of Gibbs iterations is equal to <code>burnin+mcmc</code>.     <code>burnin+mcmc</code> must be divisible by 10 and superior or equal to 100 so that the progress bar can be displayed.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>The thinning interval used in the simulation. The number of mcmc iterations must be divisible by this value.</p></td>
    </tr>
    <tr>
      <th>beta_start</th>
      <td><p>Starting values for beta parameters of the
  suitability process for each species must be either a scalar or a \(p \times n_{species}\) matrix. If <code>beta_start</code> takes a scalar value, then that value will serve for all of the betas.</p></td>
    </tr>
    <tr>
      <th>lambda_start</th>
      <td><p>Starting values for lambda parameters corresponding to the latent variables for each species must be either a scalar or a \(n_{latent} \times n_{species}\) upper triangular matrix with strictly positive values on the diagonal. If <code>lambda_start</code> takes a scalar value, then that value will serve for all of the lambdas except those concerned by the constraints explained above.</p></td>
    </tr>
    <tr>
      <th>alpha_start</th>
      <td><p>Starting values for random site effect parameters must be either a scalar or a nsite-length vector. If <code>alpha_start</code> takes a scalar value, then that value will serve for all of the alphas.</p></td>
    </tr>
    <tr>
      <th>V_alpha_start</th>
      <td><p>Starting value for variance of random site effect must be a stricly positive scalar.</p></td>
    </tr>
    <tr>
      <th>W_start</th>
      <td><p>Starting values for latent variables must be either a scalar or a \(nsite \times n_latent\) matrix. If <code>W_start</code> takes a scalar value, then that value will serve for all of the Ws.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>Shape parameter of the Inverse-Gamma prior for the random site effect variance <code>V_alpha</code>. Must be a stricly positive scalar. Default to 0.5 for weak informative prior.</p></td>
    </tr>
    <tr>
      <th>rate</th>
      <td><p>Rate parameter of the Inverse-Gamma prior for the random site effect variance <code>V_alpha</code>. Must be a stricly positive scalar. Default to 0.0005 for weak informative prior.</p></td>
    </tr>
    <tr>
      <th>mu_beta</th>
      <td><p>Means of the Normal priors for the \(\beta\) parameters of the suitability process. <code>mubeta</code> must be either a scalar or a p-length vector. If <code>mubeta</code> takes a scalar value, then that value will serve as the prior mean for all of the betas. The default value is set to 0 for an uninformative prior.</p></td>
    </tr>
    <tr>
      <th>V_beta</th>
      <td><p>Variances of the Normal priors for the \(\beta\) parameters of the suitability process. <code>Vbeta</code> must be either a scalar or a \(p \times p\) symmetric positive semi-definite square matrix. If <code>Vbeta</code> takes a scalar value,
then that value will serve as the prior variance for all of the
betas, so the variance covariance matrix used in this case is diagonal with the specified value on the diagonal. The default variance is large and set to 1.0E6 for an uninformative flat prior.</p></td>
    </tr>
    <tr>
      <th>mu_lambda</th>
      <td><p>Means of the Normal priors for the \(\lambda\) parameters corresponding to the latent variables. <code>mulambda</code> must be either a scalar or a n_latent-length vector. If <code>mulambda</code> takes a scalar value, then that value will serve as the prior mean for all of the lambdas. The default value is set to 0 for an uninformative prior.</p></td>
    </tr>
    <tr>
      <th>V_lambda</th>
      <td><p>Variances of the Normal priors for the \(\lambda\) parameters corresponding to the latent variables. <code>Vlambda</code> must be either a scalar or a \(n_{latent} \times n_{latent}\) symmetric positive semi-definite square matrix. If <code>Vlambda</code> takes a scalar value, then that value will serve as the prior variance for all of the lambdas, so the variance covariance matrix used in this case is diagonal with the specified value on the diagonal. The default variance is large and set to 10 for an uninformative flat prior.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>The seed for the random number generator. Default to 1234.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A switch (0,1) which determines whether or not the
    progress of the sampler is printed to the screen. Default is 1: a
    progress bar is printed, indicating the step (in %) reached by the Gibbs sampler.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    
 
<p></p>
<dt>mcmc.alpha</dt><dd><p>An mcmc object that contains the posterior samples for alphas. This object can be summarized by functions provided by the coda package.</p></dd>
  
  <dt>mcmc.Valpha</dt><dd><p>An mcmc object that contains the posterior samples for variance of random site effect.</p></dd>
  
  <dt>mcmc.latent</dt><dd><p>A list by latent variable of mcmc objects that contains the posterior samples for latent variables Ws.</p></dd>
    
  <dt>mcmc.sp</dt><dd><p>A list by species of mcmc objects that contains the posterior samples for betas and lambdas.</p></dd>

   <dt>mcmc.Deviance</dt><dd><p>The posterior sample of the deviance \(D\), with \(D=-2\log(\prod_{i,j} P(y_{i,j}|\beta_j,\lambda_j, \alpha_i, W_i))\), is also provided.</p></dd> 
   
  <dt>Z_latent</dt><dd><p>Predictive posterior mean of the latent variable Z.</p></dd>
    
  <dt>probit_theta_pred</dt><dd><p>Predictive posterior mean of the probability to each species to be present on each site, transformed by probit link function.</p></dd>
    
  <dt>model_spec</dt><dd><p>Model's specifications</p></dd>
      

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
    <p>We model an ecological process where the presence or absence
  of the species is explained by habitat suitability.</p>
<p><b>Ecological process:</b>
  $$y_{i,j} \sim \mathcal{B}ernoulli(\theta_{i,j})$$
  $$probit(\theta_{i,j}) = \beta_{0j} + X_i \beta_j + W_i \lambda_j + \alpha_i $$</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
    <p>Chib, S. and Greenberg, E. (1998) Analysis of multivariate probit models. <em>Biometrika</em>, 85, 347-361.</p>  
<p>Warton, D. I.; Blanchet, F. G.; O'Hara, R. B.; O'Hara, R. B.; Ovaskainen, O.; Taskinen, S.; Walker, S. C. and Hui, F. K. C. (2015) So Many Variables: Joint Modeling in Community Ecology. <em>Trends in Ecology &amp; Evolution</em>, 30, 766-779.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/coda/topics/plot.mcmc'>plot.mcmc</a></code>, <code><a href='https://www.rdocumentation.org/packages/coda/topics/summary.mcmc'>summary.mcmc</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>#==============================================</span>
<span class='co'># jSDM_probit_block()</span>
<span class='co'># Example with simulated data</span>
<span class='co'>#==============================================</span>

<span class='co'>#=================</span>
<span class='co'>#== Load libraries</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>jSDM</span>)

<span class='co'>#==================</span>
<span class='co'>#== Data simulation</span>

<span class='co'>#= Number of sites</span>
<span class='no'>nsite</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>

<span class='co'>#= Set seed for repeatability</span>
<span class='no'>seed</span> <span class='kw'>&lt;-</span> <span class='fl'>1234</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='no'>seed</span>)

<span class='co'>#= Number of species</span>
<span class='no'>nsp</span><span class='kw'>&lt;-</span> <span class='fl'>5</span>

<span class='co'>#= Number of latent variables</span>
<span class='no'>n_latent</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>

<span class='co'>#= Ecological process (suitability)</span>
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span>)
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>Int</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='no'>nsite</span>),<span class='kw'>x1</span><span class='kw'>=</span><span class='no'>x1</span>,<span class='kw'>x2</span><span class='kw'>=</span><span class='no'>x2</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span>),<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>nsite</span>,<span class='fl'>0</span>,<span class='fl'>1</span>))
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span> (<span class='no'>X</span>,<span class='no'>W</span>)
<span class='no'>beta.target</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/t'>t</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>nsp</span>*<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>),-<span class='fl'>2</span>,<span class='fl'>2</span>), <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>nsp</span>))
<span class='no'>l.zero</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>
<span class='no'>l.diag</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>2</span>)
<span class='no'>l.other</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='no'>nsp</span>*<span class='no'>n_latent</span>-<span class='fl'>3</span>,-<span class='fl'>2</span>,<span class='fl'>2</span>)
<span class='no'>lambda.target</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/t'>t</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='no'>l.diag</span>[<span class='fl'>1</span>],<span class='no'>l.zero</span>,
<span class='no'>l.other</span>[<span class='fl'>1</span>],<span class='no'>l.diag</span>[<span class='fl'>2</span>],<span class='no'>l.other</span>[-<span class='fl'>1</span>]), <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>nsp</span>))
<span class='no'>param.target</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>rbind</a></span>(<span class='no'>beta.target</span>,<span class='no'>lambda.target</span>)
<span class='no'>Valpha.target</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>V</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>alpha.target</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>nsite</span>,<span class='fl'>0</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt</a></span>(<span class='no'>Valpha.target</span>))
<span class='no'>probit_theta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='no'>X</span>) <span class='kw'>%*%</span> <span class='no'>beta.target</span> + <span class='no'>W</span> <span class='kw'>%*%</span> <span class='no'>lambda.target</span> + <span class='no'>alpha.target</span>
<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>nsp</span>*<span class='no'>nsite</span>,<span class='fl'>0</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/MathFun'>sqrt</a></span>(<span class='no'>V</span>)),<span class='no'>nsite</span>,<span class='no'>nsp</span>)
<span class='no'>Z_true</span> <span class='kw'>&lt;-</span> <span class='no'>probit_theta</span> + <span class='no'>e</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span> (<span class='fl'>NA</span>, <span class='no'>nsite</span>,<span class='no'>nsp</span>)
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>nsite</span>){
  <span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>nsp</span>){
    <span class='kw'>if</span> ( <span class='no'>Z_true</span>[<span class='no'>i</span>,<span class='no'>j</span>] <span class='kw'>&gt;</span> <span class='fl'>0</span>) {<span class='no'>Y</span>[<span class='no'>i</span>,<span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='fl'>1</span>}
    <span class='kw'>else</span> {<span class='no'>Y</span>[<span class='no'>i</span>,<span class='no'>j</span>] <span class='kw'>&lt;-</span> <span class='fl'>0</span>}
  }
}

<span class='co'>#==================================</span>
<span class='co'>#== Site-occupancy model</span>

<span class='co'># Increase number of iterations (burnin and mcmc) to get convergence </span>
<span class='no'>mod_jSDM_probit_block</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>jSDM</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/jSDM/topics/jSDM_probit_block'>jSDM_probit_block</a></span> ( <span class='kw'>presence_site_sp</span> <span class='kw'>=</span> <span class='no'>Y</span> ,
                                             <span class='kw'>site_suitability</span> <span class='kw'>=</span> ~ <span class='no'>x1</span> + <span class='no'>x2</span>,
                                             <span class='kw'>site_data</span> <span class='kw'>=</span> <span class='no'>X</span>[,-<span class='fl'>1</span>], <span class='kw'>n_latent</span><span class='kw'>=</span><span class='fl'>2</span>,
                                             <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>mcmc</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>1</span>,
                                             <span class='kw'>alpha_start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>beta_start</span><span class='kw'>=</span><span class='fl'>0</span>,
                                             <span class='kw'>lambda_start</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>W_start</span><span class='kw'>=</span><span class='fl'>0</span>,
                                             <span class='kw'>V_alpha_start</span><span class='kw'>=</span><span class='fl'>1</span>,
                                             <span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>0.5</span>, <span class='kw'>rate</span><span class='kw'>=</span><span class='fl'>0.0005</span>,
                                             <span class='kw'>mu_beta</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>V_beta</span><span class='kw'>=</span><span class='fl'>1.0E6</span>,
                                             <span class='kw'>mu_lambda</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>V_lambda</span><span class='kw'>=</span><span class='fl'>10</span>,
                                             <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>1234</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='output co'>#&gt; 
#&gt; Running the Gibbs sampler. It may be long, please keep cool :)
#&gt; 
#&gt; **********:10.0% 
#&gt; **********:20.0% 
#&gt; **********:30.0% 
#&gt; **********:40.0% 
#&gt; **********:50.0% 
#&gt; **********:60.0% 
#&gt; **********:70.0% 
#&gt; **********:80.0% 
#&gt; **********:90.0% 
#&gt; **********:100.0% </div><div class='input'>
<span class='co'># ===================================================</span>
<span class='co'># Result analysis</span>
<span class='co'># ===================================================</span>

<span class='co'>#==========</span>
<span class='co'>#== Outputs</span>

<span class='co'>#= Parameter estimates</span>

<span class='co'>## alpha</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.alpha</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 101:200
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 100 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;             Mean     SD Naive SE Time-series SE
#&gt;  [1,]  0.0431372 0.1436  0.01436       0.014335
#&gt;  [2,] -0.0078532 0.1181  0.01181       0.007146
#&gt;  [3,]  0.0111113 0.1130  0.01130       0.011298
#&gt;  [4,] -0.0154665 0.1239  0.01239       0.012070
#&gt;  [5,]  0.0212101 0.1375  0.01375       0.015754
#&gt;  [6,] -0.0067938 0.1179  0.01179       0.011792
#&gt;  [7,] -0.0041117 0.1450  0.01450       0.012306
#&gt;  [8,] -0.0147464 0.1248  0.01248       0.009993
#&gt;  [9,] -0.0143717 0.1361  0.01361       0.017615
#&gt; [10,]  0.0230310 0.1146  0.01146       0.011455
#&gt; [11,]  0.0121916 0.1174  0.01174       0.030270
#&gt; [12,]  0.0061483 0.1038  0.01038       0.023508
#&gt; [13,] -0.0187666 0.1172  0.01172       0.006713
#&gt; [14,] -0.0125043 0.1338  0.01338       0.011177
#&gt; [15,]  0.0228419 0.1464  0.01464       0.008673
#&gt; [16,]  0.0139750 0.1338  0.01338       0.013382
#&gt; [17,] -0.0059985 0.1464  0.01464       0.011332
#&gt; [18,]  0.0042399 0.1620  0.01620       0.016197
#&gt; [19,] -0.0063142 0.1334  0.01334       0.015807
#&gt; [20,]  0.0066145 0.1382  0.01382       0.013820
#&gt; [21,] -0.0259612 0.1323  0.01323       0.026441
#&gt; [22,]  0.0263646 0.1008  0.01008       0.010077
#&gt; [23,] -0.0218779 0.1421  0.01421       0.014206
#&gt; [24,]  0.0075987 0.1280  0.01280       0.009193
#&gt; [25,] -0.0225057 0.1363  0.01363       0.014852
#&gt; [26,]  0.0306662 0.1195  0.01195       0.011953
#&gt; [27,]  0.0093436 0.1299  0.01299       0.012991
#&gt; [28,] -0.0061100 0.1261  0.01261       0.012606
#&gt; [29,]  0.0290711 0.1459  0.01459       0.020770
#&gt; [30,] -0.0290261 0.1370  0.01370       0.016561
#&gt; [31,] -0.0071216 0.1224  0.01224       0.014360
#&gt; [32,] -0.0057590 0.1504  0.01504       0.014299
#&gt; [33,]  0.0207969 0.1314  0.01314       0.012776
#&gt; [34,]  0.0131830 0.1303  0.01303       0.015487
#&gt; [35,] -0.0009248 0.1475  0.01475       0.014753
#&gt; [36,]  0.0033581 0.1488  0.01488       0.014884
#&gt; [37,]  0.0138021 0.1010  0.01010       0.010098
#&gt; [38,] -0.0442372 0.1253  0.01253       0.021406
#&gt; [39,]  0.0124567 0.1617  0.01617       0.009436
#&gt; [40,] -0.0175471 0.1089  0.01089       0.009216
#&gt; [41,]  0.0657642 0.1431  0.01431       0.022776
#&gt; [42,] -0.0230670 0.1136  0.01136       0.011362
#&gt; [43,] -0.0072778 0.1207  0.01207       0.012073
#&gt; [44,]  0.0269758 0.1350  0.01350       0.020886
#&gt; [45,]  0.0118502 0.1470  0.01470       0.016586
#&gt; [46,] -0.0272223 0.1457  0.01457       0.008546
#&gt; [47,] -0.0253090 0.1264  0.01264       0.018873
#&gt; [48,]  0.0018242 0.1224  0.01224       0.015783
#&gt; [49,]  0.0150610 0.1145  0.01145       0.011448
#&gt; [50,] -0.0167126 0.1400  0.01400       0.013822
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;          2.5%      25%        50%     75%  97.5%
#&gt; var1  -0.1843 -0.04586  0.0193710 0.11617 0.4207
#&gt; var2  -0.1925 -0.09485 -0.0036036 0.05202 0.2049
#&gt; var3  -0.2176 -0.06014  0.0113031 0.07461 0.2307
#&gt; var4  -0.2365 -0.08148 -0.0167692 0.05815 0.2709
#&gt; var5  -0.2871 -0.04161  0.0277224 0.10806 0.2646
#&gt; var6  -0.2529 -0.07581 -0.0115506 0.06920 0.2220
#&gt; var7  -0.3336 -0.06484  0.0001006 0.06501 0.2648
#&gt; var8  -0.2699 -0.07531 -0.0180502 0.04647 0.2374
#&gt; var9  -0.2477 -0.07675 -0.0054562 0.05513 0.2439
#&gt; var10 -0.1814 -0.03203  0.0152090 0.09816 0.2295
#&gt; var11 -0.1763 -0.05730  0.0058007 0.06393 0.2580
#&gt; var12 -0.2052 -0.05355  0.0080482 0.06480 0.1800
#&gt; var13 -0.2467 -0.08752 -0.0108117 0.03783 0.2275
#&gt; var14 -0.3393 -0.06959  0.0002794 0.05348 0.2515
#&gt; var15 -0.3448 -0.03854  0.0217707 0.10628 0.2797
#&gt; var16 -0.2395 -0.04955  0.0040451 0.06155 0.3757
#&gt; var17 -0.3025 -0.07452 -0.0090282 0.03534 0.3846
#&gt; var18 -0.3653 -0.06998  0.0121234 0.08857 0.3235
#&gt; var19 -0.2946 -0.05907  0.0036137 0.04494 0.2575
#&gt; var20 -0.1964 -0.07843  0.0021014 0.04868 0.3258
#&gt; var21 -0.3890 -0.07101 -0.0037823 0.04197 0.2069
#&gt; var22 -0.1233 -0.04785  0.0151358 0.08072 0.2826
#&gt; var23 -0.2978 -0.11630 -0.0112058 0.06088 0.2448
#&gt; var24 -0.2850 -0.05753  0.0096743 0.07452 0.2701
#&gt; var25 -0.3233 -0.09314 -0.0186240 0.06613 0.2499
#&gt; var26 -0.1535 -0.03867  0.0108486 0.09550 0.2985
#&gt; var27 -0.2210 -0.07555 -0.0009920 0.07786 0.2869
#&gt; var28 -0.2573 -0.07661  0.0082855 0.06637 0.2455
#&gt; var29 -0.1929 -0.04298  0.0157907 0.08765 0.3336
#&gt; var30 -0.3257 -0.11349 -0.0203126 0.06022 0.2328
#&gt; var31 -0.2253 -0.07902 -0.0212696 0.05992 0.2549
#&gt; var32 -0.3018 -0.06806 -0.0102283 0.06363 0.2868
#&gt; var33 -0.2928 -0.03408  0.0229801 0.08546 0.2841
#&gt; var34 -0.1881 -0.06594 -0.0039055 0.06150 0.3360
#&gt; var35 -0.3116 -0.06641  0.0038016 0.05648 0.2563
#&gt; var36 -0.3359 -0.05912  0.0034301 0.06011 0.2886
#&gt; var37 -0.1743 -0.04837  0.0110233 0.05966 0.2245
#&gt; var38 -0.3457 -0.10804 -0.0285666 0.02769 0.1451
#&gt; var39 -0.3061 -0.06925  0.0115361 0.08666 0.3571
#&gt; var40 -0.2109 -0.07836 -0.0286475 0.04301 0.1916
#&gt; var41 -0.1753 -0.01312  0.0298969 0.11670 0.4456
#&gt; var42 -0.2957 -0.08598  0.0010500 0.05346 0.1877
#&gt; var43 -0.2288 -0.08133 -0.0064399 0.05226 0.1996
#&gt; var44 -0.2261 -0.02936  0.0083933 0.07068 0.3454
#&gt; var45 -0.3024 -0.06069  0.0162212 0.07307 0.2781
#&gt; var46 -0.2881 -0.09040 -0.0109645 0.04188 0.2321
#&gt; var47 -0.2704 -0.09283 -0.0208573 0.04363 0.2380
#&gt; var48 -0.2745 -0.06565  0.0187651 0.06758 0.2454
#&gt; var49 -0.1827 -0.05538  0.0114068 0.07245 0.2513
#&gt; var50 -0.2926 -0.08658 -0.0054293 0.05563 0.2489
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/pdf'>pdf</a></span>(<span class='kw'>file</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Posteriors_alpha_jSDM_probit_block.pdf"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>alpha.target</span>,
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.alpha</span>)<span class='kw'>[[</span><span class='fl'>1</span>]][,<span class='st'>"Mean"</span>],
<span class='kw'>xlab</span> <span class='kw'>=</span><span class='st'>"alphas target"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span><span class='st'>"alphas estimated"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>
<span class='co'>## Valpha</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.Valpha</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 101:200
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 100 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;           Mean             SD       Naive SE Time-series SE 
#&gt;       0.017453       0.015947       0.001595       0.008894 
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;     2.5%      25%      50%      75%    97.5% 
#&gt; 0.001064 0.004432 0.011471 0.027100 0.053238 
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/pdf'>pdf</a></span>(<span class='kw'>file</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Posteriors_Valpha_jSDM_probit_block.pdf"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/traceplot'>traceplot</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.Valpha</span>)
<span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/densplot'>densplot</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.Valpha</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>v</span><span class='kw'>=</span><span class='no'>Valpha.target</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>

<span class='co'>## beta_j</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span>$<span class='no'>sp_1</span>[,<span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)])</div><div class='output co'>#&gt; 
#&gt; Iterations = 1:100
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 100 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;                     Mean     SD Naive SE Time-series SE
#&gt; beta_(Intercept)  0.5783 0.2216  0.02216        0.03393
#&gt; beta_x1          -0.2932 0.2448  0.02448        0.04053
#&gt; beta_x2           0.8306 0.2424  0.02424        0.05984
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;                     2.5%     25%     50%     75%  97.5%
#&gt; beta_(Intercept)  0.1636  0.4281  0.5882  0.7269 1.0253
#&gt; beta_x1          -0.7398 -0.4568 -0.2958 -0.1375 0.2728
#&gt; beta_x2           0.4090  0.6534  0.8103  1.0244 1.2720
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/pdf'>pdf</a></span>(<span class='kw'>file</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Posteriors_beta_jSDM_probit_block.pdf"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>),<span class='fl'>2</span>))
<span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>nsp</span>) {
  <span class='kw'>for</span> (<span class='no'>p</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)) {
    <span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/traceplot'>traceplot</a></span>(<span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/mcmc'>as.mcmc</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"sp_"</span>,<span class='no'>j</span>)]][,<span class='no'>p</span>]))
    <span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/densplot'>densplot</a></span>(<span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/mcmc'>as.mcmc</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"sp_"</span>,<span class='no'>j</span>)]][,<span class='no'>p</span>]),
    <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"sp_"</span>,<span class='no'>j</span>)]])[<span class='no'>p</span>],<span class='st'>", species : "</span>,<span class='no'>j</span>))
    <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>v</span><span class='kw'>=</span><span class='no'>beta.target</span>[<span class='no'>p</span>,<span class='no'>j</span>],<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)
  }
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>
<span class='co'>## lambda_j</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span>$<span class='no'>sp_1</span>[,(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='fl'>1</span>):(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='no'>n_latent</span>)])</div><div class='output co'>#&gt; 
#&gt; Iterations = 1:100
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 100 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;            Mean     SD Naive SE Time-series SE
#&gt; lambda_1 0.3724 0.3086  0.03086        0.09261
#&gt; lambda_2 0.0000 0.0000  0.00000        0.00000
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;             2.5%    25%    50%    75% 97.5%
#&gt; lambda_1 0.02572 0.1291 0.2727 0.5863 1.097
#&gt; lambda_2 0.00000 0.0000 0.0000 0.0000 0.000
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span>$<span class='no'>sp_2</span>[,(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='fl'>1</span>):(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='no'>n_latent</span>)])</div><div class='output co'>#&gt; 
#&gt; Iterations = 1:100
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 100 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;            Mean     SD Naive SE Time-series SE
#&gt; lambda_1 -1.432 0.5798  0.05798         0.2332
#&gt; lambda_2  1.613 0.4270  0.04270         0.1684
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;             2.5%    25%    50%    75%   97.5%
#&gt; lambda_1 -2.7176 -1.756 -1.266 -1.018 -0.6708
#&gt; lambda_2  0.7985  1.335  1.572  1.910  2.4730
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/pdf'>pdf</a></span>(<span class='kw'>file</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Posteriors_lambda_jSDM_probit_block.pdf"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='no'>n_latent</span>*<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='kw'>for</span> (<span class='no'>j</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>nsp</span>) {
  <span class='kw'>for</span> (<span class='no'>l</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>n_latent</span>) {
    <span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/traceplot'>traceplot</a></span>(<span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/mcmc'>as.mcmc</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"sp_"</span>,<span class='no'>j</span>)]][,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='no'>l</span>]))
    <span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/densplot'>densplot</a></span>(<span class='kw pkg'>coda</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/coda/topics/mcmc'>as.mcmc</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"sp_"</span>,<span class='no'>j</span>)]][,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='no'>l</span>]),
    <span class='kw'>main</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.sp</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"sp_"</span>,<span class='no'>j</span>)]])[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>X</span>)+<span class='no'>l</span>],<span class='st'>",
    species : "</span>,<span class='no'>j</span>))
    <span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>v</span><span class='kw'>=</span><span class='no'>lambda.target</span>[<span class='no'>l</span>,<span class='no'>j</span>],<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)
  }
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>
<span class='co'>## W latent variables</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/pdf'>pdf</a></span>(<span class='kw'>file</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Posteriors_lv_jSDM_probit_block.pdf"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>))
<span class='kw'>for</span> (<span class='no'>l</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>n_latent</span>) {
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>W</span>[,<span class='no'>l</span>],
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.latent</span><span class='kw'>[[</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"lv_"</span>,<span class='no'>l</span>)]])<span class='kw'>[[</span><span class='fl'>1</span>]][,<span class='st'>"Mean"</span>],
<span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"Latent variable W_"</span>, <span class='no'>l</span>),
<span class='kw'>xlab</span> <span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"W_"</span>, <span class='no'>l</span>, <span class='st'>" target"</span>), <span class='kw'>ylab</span> <span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"W_"</span>, <span class='no'>l</span>, <span class='st'>" estimated"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>
<span class='co'>## Deviance</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.Deviance</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 101:200
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 100 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;           Mean             SD       Naive SE Time-series SE 
#&gt;        124.686         10.015          1.001          2.341 
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;  2.5%   25%   50%   75% 97.5% 
#&gt; 108.0 118.3 124.4 132.2 143.2 
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>mcmc.Deviance</span>)</div><div class='img'><img src='jSDM_probit_block-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#= Predictions</span>

<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/pdf'>pdf</a></span>(<span class='kw'>file</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>(), <span class='st'>"Pred-Init.pdf"</span>))
<span class='co'>## probit_theta</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>probit_theta_pred</span>)</div><div class='output co'>#&gt;        V1                V2                V3                V4         
#&gt;  Min.   :-1.2046   Min.   :-7.7269   Min.   :-4.0859   Min.   :-8.5609  
#&gt;  1st Qu.: 0.1373   1st Qu.:-0.5125   1st Qu.: 0.1048   1st Qu.:-3.9700  
#&gt;  Median : 0.6305   Median : 2.4428   Median : 1.4401   Median :-2.0468  
#&gt;  Mean   : 0.8484   Mean   : 1.8261   Mean   : 1.0136   Mean   :-0.3845  
#&gt;  3rd Qu.: 1.5579   3rd Qu.: 4.7797   3rd Qu.: 1.9887   3rd Qu.: 3.0496  
#&gt;  Max.   : 2.9850   Max.   : 9.5048   Max.   : 4.4639   Max.   :11.6020  
#&gt;        V5        
#&gt;  Min.   :-3.585  
#&gt;  1st Qu.: 1.311  
#&gt;  Median : 2.770  
#&gt;  Mean   : 2.659  
#&gt;  3rd Qu.: 4.129  
#&gt;  Max.   : 9.080  </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/par'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>probit_theta</span>,<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>probit_theta_pred</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)

<span class='co'>## Z</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>Z_latent</span>)</div><div class='output co'>#&gt;        V1                V2               V3                V4         
#&gt;  Min.   :-1.3913   Min.   :-7.784   Min.   :-4.1749   Min.   :-8.6331  
#&gt;  1st Qu.:-0.2912   1st Qu.:-1.154   1st Qu.:-0.7409   1st Qu.:-4.2520  
#&gt;  Median : 1.0528   Median : 2.584   Median : 1.6850   Median :-2.3357  
#&gt;  Mean   : 0.8703   Mean   : 1.821   Mean   : 1.0308   Mean   :-0.4052  
#&gt;  3rd Qu.: 1.6802   3rd Qu.: 4.904   3rd Qu.: 2.1735   3rd Qu.: 3.1269  
#&gt;  Max.   : 2.8359   Max.   : 9.649   Max.   : 4.3779   Max.   :11.7596  
#&gt;        V5        
#&gt;  Min.   :-3.715  
#&gt;  1st Qu.: 1.692  
#&gt;  Median : 2.926  
#&gt;  Mean   : 2.672  
#&gt;  3rd Qu.: 4.074  
#&gt;  Max.   : 9.171  </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>Z_true</span>,<span class='no'>mod_jSDM_probit_block</span>$<span class='no'>Z_latent</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/abline'>abline</a></span>(<span class='kw'>a</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/grDevices/topics/dev'>dev.off</a></span>()</div><div class='output co'>#&gt; pdf 
#&gt;   2 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jeanne Clement <a href='mailto:jeanne.clement16@laposte.net'>jeanne.clement16@laposte.net</a>
  Ghislain Vieilledent <a href='mailto:ghislain.vieilledent@cirad.fr'>ghislain.vieilledent@cirad.fr</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://ecology.ghislainv.fr'>Ghislain Vieilledent</a>, Jeanne Clément, <a href='https://www.cirad.fr'><img src='https://ecology.ghislainv.fr/images/logos/logo-cirad.svg' height=24></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

